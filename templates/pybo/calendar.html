{% extends 'base.html' %}
{% load static %}
{% load pybo_filter %}
{% block content %}
<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.9.0/fullcalendar.css" />
</head>


<div class="col-lg-10" style=" margin-top:1%; ">
    <p class="d-flex justify-content-between">
        <button class="btn btn-outline-primary" type="button" data-bs-toggle="collapse" data-bs-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
          GPT 훈련 일정 보기
        </button>
        <button class="btn btn-secondary" type="button" style="margin-right: 1%;">
            GPT 훈련 일정 만들기
        </button>
    </p>
    <div class="collapse" id="collapseExample">
        <div class="card card-body">
          훈련 일정은 다음과 같습니다.
        </div>
    </div>

    <div class="container" style="margin-top: 3%;">
        <div class="row">
           
           <div class="col-md-11">
            <div id="calendar">
            </div>
           </div>
        </div>
       </div>
       
    
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.9.0/fullcalendar.js"></script>
<script>
    $(document).ready(function () {
      var calendar = $('#calendar').fullCalendar({
          header: {
              left: 'prev,next today',
              center: 'title',
              right: 'month,agendaWeek,agendaDay'
          },
          events: '/pybo/all_events',
          selectable: true,
          selectHelper: true,
          editable: true,
          eventLimit: true,
          select: function (start, end, allDay) {
              var title = prompt("Enter Event Title");
              if (title) {
                  var start = $.fullCalendar.formatDate(start, "Y-MM-DD HH:mm:ss");
                  var end = $.fullCalendar.formatDate(end, "Y-MM-DD HH:mm:ss");
                  $.ajax({
                      type: "GET",
                      url: '/pybo/add_event',
                      data: {'title': title, 'start': start, 'end': end},
                      dataType: "json",
                      success: function (data) {
                          calendar.fullCalendar('refetchEvents');
                          alert("Added Successfully");
                      },
                      error: function (data) {
                          alert('There is a problem1!!!');
                      }
                  });
              }
          },
          eventResize: function (event) {
              var start = $.fullCalendar.formatDate(event.start, "Y-MM-DD HH:mm:ss");
              var end = $.fullCalendar.formatDate(event.end, "Y-MM-DD HH:mm:ss");
              var title = event.title;
              var id = event.id;
              $.ajax({
                  type: "GET",
                  url: '/pybo/update',
                  data: {'title': title, 'start': start, 'end': end, 'id': id},
                  dataType: "json",
                  success: function (data) {
                      calendar.fullCalendar('refetchEvents');
                      alert('Event Update');
                  },
                  error: function (data) {
                      alert('There is a problem2!!!');
                  }
              });
          },

          eventDrop: function (event) {
              var start = $.fullCalendar.formatDate(event.start, "Y-MM-DD HH:mm:ss");
              var end = $.fullCalendar.formatDate(event.end, "Y-MM-DD HH:mm:ss");
              var title = event.title;
              var id = event.id;
              $.ajax({
                  type: "GET",
                  url: '/pybo/update',
                  data: {'title': title, 'start': start, 'end': end, 'id': id},
                  dataType: "json",
                  success: function (data) {
                      calendar.fullCalendar('refetchEvents');
                      alert('Event Update');
                  },
                  error: function (data) {
                      alert('There is a problem3!!!');
                  }
              });
          },

          eventClick: function (event) {
              if (confirm("Are you sure you want to remove it?")) {
                  var id = event.id;
                  $.ajax({
                      type: "GET",
                      url: '/pybo/remove',
                      data: {'id': id},
                      dataType: "json",
                      success: function (data) {
                          calendar.fullCalendar('refetchEvents');
                          alert('Event Removed');
                      },
                      error: function (data) {
                          alert('There is a problem4!!!');
                      }
                  });
              }
          },

      });
  });

</script>
 

{% endblock %}